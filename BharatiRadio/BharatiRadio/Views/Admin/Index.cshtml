
@model BharatiRadio.Models.AdminViewModel

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="@("https://unpkg.com/@phosphor-icons/web")"></script>
    <link href="~/Content/dashboard.css" rel="stylesheet">
    <script>
        var newBulletinUrl = '@Url.Action("NewBulletin", "Admin")';
        var editBulletinUrl = '@Url.Action("EditBulletin", "Admin")';
    </script>
    <script src="~/Content/dashboard.js" defer></script>

</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <i class="ph-fill ph-radio logo-icon"></i>
            <h2>Admin Panel</h2>
        </div>
        <nav class="sidebar-nav">
            <a href="#" class="nav-link active" data-target="dashboard">
                <i class="ph-fill ph-gauge"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-link" data-target="bulletins">
                <i class="ph-fill ph-newspaper"></i>
                <span>Manage Bulletins</span>
            </a>
            <a href="#" class="nav-link" data-target="suggestions">
                <i class="ph-fill ph-lightbulb"></i>
                <span>Suggestions</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="/Auth/LogOut" class="btn btn-secondary" style="width: 100%;">
                <i class="ph-fill ph-sign-out"></i>
                <span>Logout</span>
            </a>
        </div>
    </aside>
    <main class="main-content" id="main-content">
        <header class="header">
            <div class="header-left">
                <button id="menu-toggle" title="Toggle Menu">
                    <i class="ph-fill ph-list"></i>
                </button>
                <h1 id="page-title">Dashboard</h1>
            </div>
            <div class="user-profile">
                <br />
                <span>Welcome, @Session["UserName"]</span>
                <img src="https://placehold.co/40x40/e2e8f0/334155?text=A" alt="Admin user avatar">
            </div>
        </header>

        <div class="content">
            <section id="dashboard" class="content-section active">
                <div class="card-grid">
                    <div class="card">
                        <div class="card-icon icon-bulletin">
                            <i class="ph ph-newspaper"></i>
                        </div>
                        <div class="card-info">
                            <h3>@Model.Bulletins.Count()</h3>
                            <p>Total Bulletins</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-icon icon-podcasts">
                            <i class="ph ph-broadcast"></i>
                        </div>
                        <div class="card-info">
                            <h3>@Model.Feedbacks.Where(model => model.viewed == 0).Count()</h3>
                            <p>Unread Suggestions</p>
                        </div>
                    </div>

                </div>
            </section>

            <section id="bulletins" class="content-section">
                <div class="toolbar">
                    <div class="toolbar-left">
                        <button class="btn btn-primary" id="createNewBulletinBtn">
                            <i class="ph-fill ph-plus-circle"></i>
                            <span>Create New Bulletin</span>
                        </button>
                    </div>
                    <div class="toolbar-right">
                        <div class="search-bar">
                            <i class="ph ph-magnifying-glass"></i>
                            <input type="text" placeholder="Search bulletins..." id="search-bulletin">
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="bulletin-table">
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Tag</th>
                                <th>Status</th>
                                <th>Content</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Bulletins)
                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.title)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.tag)
                                    </td>
                                    <td>
                                        <span class="status status-published">
                                            @Html.DisplayFor(modelItem => item.status)
                                        </span>
                                    </td>
                                    <td class="limit-text">
                                        @Html.DisplayFor(modelItem => item.content)
                                    </td>
                                    <td>
                                        <button class="btn btn-action btn-edit" title="Edit" data-id="@item.Id">
                                            <i class="ph-fill ph-pencil-simple"></i>
                                        </button>
                                        <button class="btn btn-action btn-delete" title="Delete" data-id="@item.Id" data-ids="DeleteBulletin">
                                            <i class="ph-fill ph-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
            </section>
            <section id="suggestions" class="content-section">
                <h2>View Suggestions</h2>
                <br />
                <div class="table-wrapper">
                    <table id="suggestion-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Contact No.</th>
                                <th>Subject</th>
                                <th>
                                    <select id="suggestion-filter" name="status" style="padding:5px;" required>
                                        <option value="All">All</option>
                                        <option value="Saved">Saved</option>
                                        <option value="Viewed">Viewed</option>
                                        <option value="Unread">Unread</option>
                                    </select>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.Feedbacks)
                            {
                                <tr style="font-weight:@(item.viewed == 0 ? "bold" : "normal"); background-color:@(item.viewed == 0 ? "white" : "#E8E9EB")">
                                    <td>
                                        @Html.DisplayFor(modelItem => item.name)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.email)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.contact_no)
                                    </td>
                                    <td class="limit-text">
                                        @Html.DisplayFor(modelItem => item.subject)
                                    </td>
                                    <td style="display:none;">
                                        @item.marked
                                    </td>
                                    <td style="display:none;">
                                        @item.viewed
                                    </td>
                                    <td>
                                        <button class="btn btn-action btn-view-suggestion" title="View" data-id="@item.Id">
                                            <i class="ph ph-eye"></i>
                                        </button>
                                        <button class="btn btn-action btn-delete" title="Delete" data-id="@item.Id" data-ids="DeleteSuggestion">
                                            <i class="ph-fill ph-trash"></i>
                                        </button>
                                    </td>
                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
            </section>

        </div>
    </main>

    <!--Create/Edit Modal -->
    <div class="modal-overlay" id="bulletin-modal">
        <div class="modal-box">
            <div class="modal-header">
                <h2 id="modal-title">Create New Bulletin</h2>
                <button class="modal-close-btn" data-dismiss="modal">
                    <i class="ph-fill ph-x"></i>
                </button>
            </div>
            <form id="bulletin-form" method="post" action="@Url.Action("NewBulletin", "Admin")">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="bulletin-title">Title</label>
                        <input type="text" id="bulletin-title" placeholder="Enter bulletin title" name="title" required>
                        <input type="hidden" name="id" id="bulletin-id" />
                    </div>

                    <div class="form-group">
                        <label for="bulletin-status">Category</label>
                        <select id="bulletin-status" name="status" required>
                            <option value="Draft">Draft</option>
                            <option value="Published">Published</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bulletin-tag">Tag</label>
                        <input type="text" id="bulletin-tag" placeholder="Enter bulletin tag..." name="tag" required>
                    </div>

                    <div class="form-group">
                        <label for="bulletin-content">Content</label>
                        <textarea id="bulletin-content" placeholder="Write your bulletin content here..." name="content"></textarea>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary bulletin-btn">Save Bulletin</button>
                </div>
            </form>
        </div>
    </div>
    <div class="modal-overlay" id="suggestion-modal">
        <div class="modal-box">
            <div class="modal-header">
                <h2 id="modal-title">Suggestion</h2>
                <div class="btn-group" style="display:flex;">
                    <button class="modal-close-btn mark-btn" data-bookmark="true" title="Bookmarked" style="margin:0px 10px;" mark-id="">
                        <i class="ph-fill ph-bookmark bookmark-green"></i>
                    </button>

                    <button class="modal-close-btn" data-dismiss="modal">
                        <i class="ph-fill ph-x"></i>
                    </button>
                </div>
            </div>
            <form id="suggestion-form" method="post" action="@Url.Action("DeleteSuggestion", "Admin")">
                <input type="hidden" id="delete-item-val" name="Id" value="" />
                <div class="form-grid">
                    <div class="form-group">
                        <label for="suggestion-subject">Subject</label>
                        <span id="sugg-sub"></span>
                    </div>

                    <div class="form-group">
                        <label for="suggestion-category">Name</label>
                        <span id="sugg-name"> </span>
                    </div>

                    <div class="form-group">
                        <label for="suggestion-email">Email</label>
                        <span id="sugg-email"> </span>
                    </div>

                    <div class="form-group">
                        <label for="suggestion-contact">Contact No.</label>
                        <span id="sugg-contact"> </span>
                    </div>

                    <div class="form-group">
                        <label for="suggestion-location">Location</label>
                        <span id="sugg-loction"></span>
                    </div>

                    <div class="form-group">
                        <label for="suggestion-msg">Message</label>
                        <span id="sugg-msg"></span>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Delete</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Delete Confirmation Modal-->
    <div class="modal-overlay" id="delete-modal">
        <div class="modal-box" style="max-width: 450px;">
            <div class="modal-header">
                <h2 id="modal-title">Confirm Deletion</h2>
                <button class="modal-close-btn" data-dismiss="modal">
                    <i class="ph-fill ph-x"></i>
                </button>
            </div>
            <p style="margin-bottom: 1.5rem; color: #475569;">Are you sure you want to delete this item? This action cannot be undone.</p>
            <div class="modal-footer" style="border-top: none; padding-top: 0;">
                <form method="post" action="@Url.Action("DeleteBulletin", "Admin")" id="delete-confirm-box">
                    <input type="hidden" id="delete-item-val" name="Id" value="" />
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn" style="background-color: #e11d48; color: white;">
                        <i class="ph-fill ph-trash"></i>
                        <span>Yes, Delete</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>
